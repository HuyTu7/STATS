---
title: "Data Management Template"
author: ""
date: "`r Sys.Date()`"
output: html_document
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(comment = NA, message = FALSE, warning = FALSE, fig.align = "center")
library(dplyr)
library(ggplot2)
library(descr)
```

### Purpose of Study:

The present study will examine young adults from the The National Longitudinal Study of Adolescent to Adult Health (AddHealth). The goals of the analysis will include 1) establishing the relationship between being in an abusive relationship and individual’s well-being in that abusive relationship; 2) determining whether or not the different forms of abuse would make different impact to the well-being state of individuals in that abusive relationship; 3) determine how the association/relationship between being in an abusive relationship and individual’s well-being in that abusive relationship may shape differently taking in consideration of ethnicity, age, and sexual orientation. 

### Variables:

Variables from AddHealth that will be used include:  H4RD7B (Satisfaction level with the way individuals handle their problems and disagreements), H4RD9 (The level of happiness for being in a relationship), H4RD18 (The frequency of physical abuse threats and attempts), and H4RD20 (The frequency of physical injures), H4RD21 (The frequency of non-consensual sexual activities").  ￼

### Data Management

First, the data is placed on the search path using the `PDS` package.
The variables of interest are selected and stored in the data frame `NDF` using the `select` function from the `dplyr` package.

```{r}
library(PDS)
NDF <- addhealth_public4 %>%
  rename(SatisfactionWConflict = h4rd7b, HappinessLevel = h4rd9, PhysicalAbuseAttempts = h4rd18, PhysicalInjure = h4rd20, SexualAssaults = h4rd21) %>%
  select(SatisfactionWConflict, HappinessLevel, PhysicalAbuseAttempts, PhysicalInjure, SexualAssaults)
summary(NDF)
```


### Labeling Variables

In the next section of code, responses to the questions are labeled and levels of factors are given informative labels.  The order of the levels is also rearranged for the variables `SatisfactionWConflict`, `HappinessLevel`, `PhysicalAbuseAttempts`, `PhysicalInjure`, and `SexualAssaults` , the number of responses is pulled. Then, the factors are given readable names instead of being named with numbers.

The first variables examined are the variables related to the level of satisfactions level with the way individuals handle their problems and disagreements. 
```{r}
xtabs(~SatisfactionWConflict, data = NDF)
NDF$SatisfactionWConflict[NDF$SatisfactionWConflict==96 | NDF$SatisfactionWConflict==98] <- NA
NDF$SatisfactionWConflict <- factor(NDF$SatisfactionWConflict, labels = c("strongly agree", "agree", "neither agree nor disagree", "disagree","strongly disagree"))[, drop = TRUE]
xtabs(~SatisfactionWConflict, data = NDF)
```

The second variables examined are the variables related to the level of happiness of indivduals with their romantic relationship.  
```{r}
xtabs(~HappinessLevel, data = NDF)
NDF$HappinessLevel[NDF$HappinessLevel>=6] <- NA
NDF$HappinessLevel <- factor(NDF$HappinessLevel, labels = c("very happy", "fairly happy", "not too happy"))[, drop = TRUE]
xtabs(~HappinessLevel, data = NDF)
```

The third variables examined are the variables related to the physical abuse threats and attempts toward the other partner in the romantic relationship.  
```{r, fig.width = 20, fig.height = 30}
xtabs(~PhysicalAbuseAttempts, data = NDF)
NDF$PhysicalAbuseAttempts[NDF$PhysicalAbuseAttempts>=9] <- NA
NDF$PhysicalAbuseAttempts <- factor(NDF$PhysicalAbuseAttempts, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~PhysicalAbuseAttempts, data = NDF)
```

The fourth variables examined are the variables related to the individuals' physical abuse injure frequency in the romantic relationship.  
```{r}
xtabs(~PhysicalInjure, data = NDF)
NDF$PhysicalInjure[NDF$PhysicalInjure>=9] <- NA
NDF$PhysicalInjure <- factor(NDF$PhysicalInjure, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~PhysicalInjure, data = NDF)
```

The fifth variables examined are the variables related to the non-consensual sexual activities that the individuals were forced to engage in, in the domestic relationship.
```{r}
xtabs(~SexualAssaults, data = NDF)
NDF$SexualAssaults[NDF$SexualAssaults>=9] <- NA
NDF$SexualAssaults <- factor(NDF$SexualAssaults, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~SexualAssaults, data = NDF)
```


### Variables
The barplots are all created with the package `ggplot2`.  The barplots start with the defaults for the `geom_bar` and add more detail to the plot with each graph. 

The first graph showed the variables related to the satisfactions with how individuals resolving conflicts or arguments in the relationship. And the graph is skewed right distribution. There is a big population that skipped out the question in comparison to other questions.      
```{r, fig.width = 12, fig.height = 6}
library(ggplot2)

ggplot(data = NDF, aes(x = SatisfactionWConflict, fill = SatisfactionWConflict)) + 
  geom_bar() + 
  labs(title = "I (am/was) satisfied with the way we handle our problems and
disagreements", x = "Response to the way individuals \n handle their problems and
disagreements in a relationship") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5)) +
  guides(fill = guide_legend(title = "The  with the way we handle our problems and
disagreements"))
```

The second graph showed the variables related to thelevel of happiness of indivduals with their romantic relationship. And the graph is skewed right distribution. 
```{r, fig.width = 10, fig.height = 6}
ggplot(data = NDF, aes(x = HappinessLevel, fill = HappinessLevel)) + 
  geom_bar() + 
  labs(title = " In general, how happy are you in your relationship with {initials}?", x = "Response about how happy \n are the individuals in their relationship?") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5)) + 
  guides(fill = guide_legend(title = "In general, how happy the individuals are in their relationship?"))
```

The third graph portrays the variables related to the physical abuse threats and attempts toward the other partner in the romantic relationship. The graph is very similar to skewed right distribution. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = na.omit(NDF), aes(x = PhysicalAbuseAttempts, fill = PhysicalAbuseAttempts)) + 
  geom_bar() + 
  labs(title = "How often (has/did) {initials} (threatened/threaten) you with violence, (pushed/push) \n or (shoved/shove) you, or (thrown/throw) something at you that could hurt? ", x = "Response to the frequency of physical abuse threats and attempts") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 12)) + 
  guides(fill = guide_legend(title = "The frequency of physical abuse threats and attempts", legend.key.size = 12))
```

The fourth graph portrays the variables related to the individuals' physical abuse injure frequency in the romantic relationship. There was an overwhelming majority that legitimately skip or ignore the question which it is hard to make conjecture on the reason why they did it. The graph is very similar to skewed right distribution. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = na.omit(NDF), aes(x = PhysicalInjure, fill = PhysicalInjure)) + 
  geom_bar() + 
  labs(title = "How often (have/did) you (had/have) an injury, such as \n a sprain, bruise, or cut because of a fight with {initials}? ", x = "Response to the frequeny of physical injures") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 12)) +
  guides(fill = guide_legend(title = "The frequency of physical injures"))
```

The fifth graph portrays the variables related to the non-consensual sexual activities that the individuals were forced to engage in, in the domestic relationship. The graph is very similar to skewed right distribution. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = na.omit(NDF), aes(x = SexualAssaults, fill = SexualAssaults)) + 
  geom_bar() + 
  labs(title = " How often (has/did) {initials} (insisted/insist) on or (made/make) \n you have sexual relations with (him/her) when you didn't want to?", x = "Response to the frequeny of non-consensual sexual activities") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 12)) +
  guides(fill = guide_legend(title = "The frequency of non-consensual sexual activities"))
```


