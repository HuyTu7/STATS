---
title: "LinearRegressionAssignment"
date: "`r Sys.Date()`"
output: html_document
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(comment = NA, message = FALSE, warning = FALSE, fig.align = "center")
library(dplyr)
library(ggplot2)
library(descr)
```

### Purpose of Study:

The present study will examine young adults from the The National Longitudinal Study of Adolescent to Adult Health (AddHealth). The goals of the analysis will include 1) establishing the relationship between being in an abusive relationship and individual’s happiness in that abusive relationship; 2) determining whether or not the different forms of abuse would make different impacts to the well-being state of individuals in that abusive relationship; 3) determine how the association/relationship between being in an abusive relationship and individual’s well-being in that abusive relationship may shape differently taking in consideration of ethnicity, age, and sexual orientation. 

### Variables:

Variables from AddHealth that will be used include:  H4RD2Y (The total amount of time that the individual were involved in a romantic or sexual relationship with their partner), H4RD5 (The amount of nights on an average week when you and your partner spent the night together), H4RD7B (Satisfaction level with the way individuals handle their problems and disagreements), H4RD9 (The level of happiness of individuals in the relationship), H4RD18 (The frequency of physical abuse threats and attempts), H4RD20 (The frequency of physical injures), H4RD21 (The frequency of non-consensual sexual activities"), H4TR1(The number of people you have married).  ￼

### Data Management

First, the data is placed on the search path using the `PDS` package.
The variables of interest are selected and stored in the data frame `NDF` using the `select` function from the `dplyr` package. Then, those variables of interest are renamed and given more reasonable names instead of the original unique identifiers from the codebook.

```{r}
library(PDS)
NDF <- addhealth_public4 %>%
  rename(TimeSpent = h4rd2y, NightsSpent = h4rd5, SatisfactionWConflict = h4rd7b, HappinessLevel = h4rd9, PhysicalAbuseAttempts = h4rd18, PhysicalInjure = h4rd20, SexualAssaults = h4rd21, PeopleMarried = h4tr1, CigsSmoke = h4to6, SmokeFreq = h4to5 ) %>%
  select(TimeSpent, NightsSpent, SatisfactionWConflict, HappinessLevel, PhysicalAbuseAttempts, PhysicalInjure, SexualAssaults, PeopleMarried, CigsSmoke, SmokeFreq)
summary(NDF)

NDF3 <- NDF %>%
  select(HappinessLevel, PhysicalAbuseAttempts, SexualAssaults)
```


### Labeling Variables

In the next section of code, responses to the questions are labeled and levels of factors are given informative labels.  The order of the levels is also rearranged for the variables `TimeSpent`, `SatisfactionWConflict`, `HappinessLevel`, `PhysicalAbuseAttempts`, `PhysicalInjure`, and `SexualAssaults`, the number of responses is pulled. Then, the factors are given readable names instead of being named with numbers.

The first variables examined are the variables related to the level of satisfactions level with the way individuals handle their problems and disagreements. 
```{r}
xtabs(~SatisfactionWConflict, data = NDF)
NDF$SatisfactionWConflict[NDF$SatisfactionWConflict==96 | NDF$SatisfactionWConflict==98] <- NA
NDF$SatisfactionWConflict <- factor(NDF$SatisfactionWConflict, labels = c("strongly agree", "agree", "neither agree nor disagree", "disagree","strongly disagree"))[, drop = TRUE]
xtabs(~SatisfactionWConflict, data = NDF)
```

The second variables examined are the variables related to the level of happiness of individuals with their romantic relationship.  
```{r}
xtabs(~HappinessLevel, data = NDF)
NDF$HappinessLevel[NDF$HappinessLevel>=6] <- NA
NDF3$HappinessLevel[NDF3$HappinessLevel>=6] <- NA
NDF$HappinessLevel <- factor(NDF$HappinessLevel, labels = c("very happy", "fairly happy", "not too happy"))[, drop = TRUE]
xtabs(~HappinessLevel, data = NDF)
```

The third variables examined are the variables related to the physical abuse threats and attempts toward the other partner in the romantic relationship.  
```{r, fig.width = 20, fig.height = 30}
xtabs(~PhysicalAbuseAttempts, data = NDF)
NDF$PhysicalAbuseAttempts[NDF$PhysicalAbuseAttempts>=9] <- NA
NDF3$PhysicalAbuseAttempts[NDF3$PhysicalAbuseAttempts>=9] <- NA

NDF$PhysicalAbuseAttempts <- factor(NDF$PhysicalAbuseAttempts, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~PhysicalAbuseAttempts, data = NDF)
```

The fourth variables examined are the variables related to the individuals' physical abuse injure frequency in the romantic relationship.  
```{r}
xtabs(~PhysicalInjure, data = NDF)
NDF$PhysicalInjure[NDF$PhysicalInjure>=9] <- NA
NDF$PhysicalInjure <- factor(NDF$PhysicalInjure, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~PhysicalInjure, data = NDF)
```

The fifth variables examined are the variables related to the non-consensual sexual activities that the individuals were forced to engage in, in the domestic relationship.
```{r}
xtabs(~SexualAssaults, data = NDF)
NDF$SexualAssaults[NDF$SexualAssaults>=9] <- NA
NDF3$SexualAssaults[NDF3$SexualAssaults>=9] <- NA
NDF$SexualAssaults <- factor(NDF$SexualAssaults, labels = c("never", "this has not happened in the past year, but it did happen before then ", "once in the last year of the relationship","twice in the last year of the relationship", "3 to 5 times in the last year of the relationship","6 to 10 times in the last year of the relationship", "11 to 20 times in the last year of the relationship", "more than 20 times in the last year of the relationship"))[, drop = TRUE]
xtabs(~SexualAssaults, data = NDF)
```

The sixth variables examined are the variables related to the amount of time spent of the individual were involved in a romantic or sexual relationship with their partner.
```{r}
xtabs(~TimeSpent, data = NDF)
NDF$TimeSpent[NDF$TimeSpent == 96] <- NA
NDF$TimeSpent[NDF$TimeSpent == 98] <- NA
NDF$TimeSpent <- factor(NDF$TimeSpent, labels = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19))[, drop = TRUE]
xtabs(~TimeSpent, data = NDF)
```

The seventh variables examined are the variables related to the amount of time spent of the individual were involved in a romantic or sexual relationship with their partner.
```{r}
xtabs(~NightsSpent, data = NDF)
NDF$NightsSpent[NDF$NightsSpent>=8] <- NA
NDF$NightsSpent <- factor(NDF$NightsSpent, labels = c(0, 1, 2, 3, 4, 5, 6, 7))[, drop = TRUE]
xtabs(~NightsSpent, data = NDF)
```

The eighth variable examined is the variable related to the number of people the individual had ever married (including the current spouse if the individual is married at that current moment) 

```{r}
xtabs(~PeopleMarried, data = NDF)
NDF$PeopleMarried[NDF$PeopleMarried>=5] <- NA
NDF$PeopleMarried <- factor(NDF$PeopleMarried, labels = c(0, 1, 2, 3, 4))[, drop = TRUE]
xtabs(~PeopleMarried, data = NDF)
```


### Variables
The barplots are all created with the package `ggplot2`.  The barplots start with the defaults for the `geom_bar` and add more detail to the plot with each graph. 

The first graph showed the variables related to the satisfactions with how individuals resolving conflicts or arguments in the relationship range from strongly disagree to strongly agree. And the graph is skewed right distribution. There is a big population that skipped out the question in comparison to other questions. 

```{r, fig.width = 12, fig.height = 6}
library(ggplot2)

ggplot(data = NDF, aes(x = SatisfactionWConflict, fill = SatisfactionWConflict)) + 
  geom_bar() + 
  labs(title = "I (am/was) satisfied with the way we handle our problems and disagreements", x = "Response to the way individuals \n handle their problems and
disagreements in a relationship") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5)) +
  guides(fill = guide_legend(title = "The  with the way we handle our problems and
disagreements"))
```

The second graph showed the variables related to the level of happiness of individuals with their romantic relationship including very happy, fairly happy, and not too happy. And the graph is skewed right distribution. 
```{r, fig.width = 10, fig.height = 6}
ggplot(data = NDF, aes(x = HappinessLevel, fill = HappinessLevel)) + 
  geom_bar() + 
  labs(title = " In general, how happy are you in your relationship with {initials}?", x = "Response about how happy \n are the individuals in their relationship?") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5)) + 
  guides(fill = guide_legend(title = "In general, how happy the individuals are in their relationship?"))
```

From the third graph to the fifth graph, there are 7 responses that the individuals can choose range from "this has not happened in the past year but it did happen before" to "more than 20 times in the past year in the relationship". The third graph portrays the variables related to the physical abuse threats and attempts toward the other partner in the romantic relationship. I omitted the NA population so the graph can be easily analyzed and representable to identify the behavior. The graph is very similar to skewed right distribution. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = PhysicalAbuseAttempts, fill = PhysicalAbuseAttempts)) + 
  geom_bar() + 
  labs(title = "How often (has/did) {initials} (threatened/threaten) you with violence, (pushed/push) \n or (shoved/shove) you, or (thrown/throw) something at you that could hurt? ", x = "Response to the frequency of physical abuse threats and attempts") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 13)) + 
  guides(fill = guide_legend(title = "The frequency of physical abuse threats and attempts", legend.key.size = 12))
```

The fourth graph portrays the variables related to the individuals' physical abuse injure frequency in the romantic relationship. There was an overwhelming majority that legitimately skip or ignore the question which it is hard to make conjecture on the reason why they did it. Therefore, I omitted that population so the graph can be easily analyzed and representable to identify the behavior. The graph is very similar to skewed right distribution. The majority responded never but there was still considerable populations that experienced physical injures in their relationships. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = na.omit(NDF), aes(x = PhysicalInjure, fill = PhysicalInjure)) + 
  geom_bar() + 
  labs(title = "How often (have/did) you (had/have) an injury, such as \n a sprain, bruise, or cut because of a fight with {initials}? ", x = "Response to the frequeny of physical injures") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 13)) +
  guides(fill = guide_legend(title = "The frequency of physical injures"))
```

The fifth graph portrays the variables related to the non-consensual sexual activities that the individuals were forced to engage in, in the domestic relationship. I omitted the NA population so the graph can be easily analyzed and representable to identify the behavior. The graph is very similar to skewed right distribution. There was a more significant majority responded never to the non-consensual sexual activities that they engage in compare to the previous question of the frequency of physical injures. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = na.omit(NDF), aes(x = SexualAssaults, fill = SexualAssaults)) + 
  geom_bar() + 
  labs(title = " How often (has/did) {initials} (insisted/insist) on or (made/make) \n you have sexual relations with (him/her) when you didn't want to?", x = "Response to the frequeny of non-consensual sexual activities") +
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 13)) +
  guides(fill = guide_legend(title = "The frequency of non-consensual sexual activities"))
```

The sixth graph portrays the variables related to the amount of time that the individual spent together with their significant other in a sexual or romantic relationship. I omitted the NA population so the graph can be easily analyzed and representable to identify the behavior. The mean of the graph is around at 4.576 years and the median is 4 years. The graph distribution is skewed right.
```{r}
NDF$TimeSpent <- gsub(",", "", NDF$TimeSpent)   # remove comma
NDF$TimeSpent <- as.numeric(NDF$TimeSpent)
hist(NDF$TimeSpent, xlab = "Time Spent Together(in years)", main= "The amount of time that the individual \n spent with their significant other", col= "light blue", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19))
summary(NDF$TimeSpent)
fivenum(NDF$TimeSpent)
```


The seventh graph portrays the variables related to the amount of time that the individual spent together with their significant other in a sexual or romantic relationship. I omitted the NA population so the graph can be easily analyzed and representable to identify the behavior. The mean of the graph is around at 2.803 nights and the median is 2.0 years. The graph distribution is skewed right.
```{r}
NDF$NightsSpent <- gsub(",", "", NDF$NightsSpent)   
NDF$NightsSpent <- as.numeric(NDF$NightsSpent)
hist(NDF$NightsSpent, xlab = "Nights Spent Together On Average Week", main= "The days on an average week that the individual \n spent with their significant other", col= "light blue", breaks=c(0,1,2,3,4,5,6,7))
summary(NDF$NightsSpent)
fivenum(NDF$NightsSpent)
```


The eighth graph is a bivariate graph which shows the relationship as fraction of Physical Abuse Attempts Frequencies targeting individuals in the relationship by their Satisfaction Level with Conflict. 
```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = PhysicalAbuseAttempts, fill = SatisfactionWConflict)) + 
  geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of Physical Abuse Attempts Frequencies \notargeting individuals in the relationship \nby their Statisfaction Level with Conflict") + 
  scale_fill_manual(values = c("red", "green", "orange", "blue", "violet"), name = "Statisfaction Level with Conflict Status") + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  theme(axis.text.x  = element_text(angle = 85, vjust = 0.5, size = 14))
```

The tenth graph is a bivariate graph which shows the relationship as fraction of Non-Consensual Sexual Activities or Sexual Assault Frequencies targeting individuals in the relationship by their Satisfaction Level with Conflict.
```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = SexualAssaults, fill = SatisfactionWConflict)) + 
  geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of Sexual Assaults Frequencies \ntargeting individuals in the relationship \nby their Statisfaction Level with Conflict") + 
       scale_fill_manual(values = c("red", "green", "orange", "blue", "violet"), name = "Statisfaction Level with Conflict Status") + 
       guides(fill = guide_legend(reverse = TRUE)) + 
       theme(axis.text.x  = element_text(angle = 85, vjust = 0.5, size = 14))
```

The eleventh graph is a bivariate graph which shows the relationship as fraction of Happiness Level of individuals in the relationship by their Satisfaction Level with Conflict.
```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = HappinessLevel, fill = SatisfactionWConflict)) + 
        geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of Happiness Level of individuals in the relationship \nby their Statisfaction Level with Conflict") + 
  scale_fill_manual(values = c("red", "orange", "green",  "blue", "violet"), name = "Happiness Level Status") + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  theme(axis.text.x  = element_text(angle = 85, vjust = 0.5, size = 14))
```

The twelfth graph is a multivariate graph shows the relationship as fraction of frequency of physical abuse attempts that the individual experienced from their partner happiness level status by the frequency of being the victim of sexual assaults.
```{r,  fig.width = 14, fig.height = 15}
ggplot(data = NDF, aes(x = SexualAssaults, fill = HappinessLevel)) + 
  geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of the frequency of physical abuse attempts that the individual experienced\n from their partner happiness level status \nby the frequency of being the victim of sexual assaults") + 
  scale_fill_manual(values = c("red", "yellow", "blue"), name = "Happiness Level Status") + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  facet_grid(PhysicalAbuseAttempts ~ .) + 
  theme(axis.text.x  = element_text(angle = 85, vjust = 0.5, size = 14))
```


```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = PhysicalAbuseAttempts, fill = HappinessLevel)) + 
  geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of Physical Abuse Frequencies \n targeting individuals in the relationship \nby their Happiness Level") + 
  scale_fill_manual(values = c("red", "yellow", "blue"), name = "Happiness Level Status:") + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  theme(axis.text.x  = element_text(angle = 70, vjust = 0.5, size = 14))
```


```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF, aes(x = SexualAssaults, fill = HappinessLevel)) + 
  geom_bar(position = "fill") +
  theme_bw() + 
  labs(x = "", y = "Fraction", 
       title = "Fraction of Sexual Assaults Frequencies \n targeting individuals in the relationship \nby their Happiness Level") + 
  scale_fill_manual(values = c("red", "yellow", "blue"), name = "Happiness Level Status:") + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  theme(axis.text.x  = element_text(angle = 70, vjust = 0.5, size = 14))
```

###ANOVA

```{r, fig.width = 14, fig.height = 10}
NDF2 <- NDF %>%
  select(TimeSpent, PhysicalAbuseAttempts)
NDF2 = na.omit(NDF2)
NDF11 <- NDF %>%
  select(TimeSpent, SexualAssaults)
NDF11 = na.omit(NDF11)
summary(NDF2)
tapply(NDF2$TimeSpent, NDF2$PhysicalAbuseAttempts, mean)
tapply(NDF2$TimeSpent, NDF2$PhysicalAbuseAttempts, sd)
PAA <- rep(NA, length(NDF2$PhysicalAbuseAttempts))
```

This graph is a boxplot graph shows the relationship of physical abuse attempts versus time spent together in years. There are some outliers but beside that the means and medians of variables are very similar to each other.The distribution is slightly skewed right as shown in the graph below:
```{r, fig.width = 14, fig.height = 10}
library(ggplot2)
ggplot(data = NDF2, aes(x = PhysicalAbuseAttempts, y = TimeSpent, fill = PhysicalAbuseAttempts)) +
  geom_boxplot() +
  theme_bw() + 
  guides(fill = FALSE) + 
  labs(x = "Physical Abuse Frequency", y = "Time Spent Together(in years)", title = "Physical Abuse Frequency By Time Spent Together") +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 14))
```

```{r, fig.width = 14, fig.height = 10}
library(ggplot2)
ggplot(data = NDF11, aes(x = SexualAssaults, y = TimeSpent, fill = SexualAssaults)) +
  geom_boxplot() +
  theme_bw() + 
  guides(fill = FALSE) + 
  labs(x = "Sexual Assaults Frequency", y = "Time Spent Together(in years)", title = "Sexual Assaults By Time Spent Together") +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 14))
```

This graph is a violin graph shows the relationship of physical abuse attempts versus time spent together in years. The means and medians of variables are very similar to each other. The distribution is slightly skewed right as shown in the graph below:

```{r, fig.width = 14, fig.height = 10}
ggplot(data = NDF2, aes(x = PhysicalAbuseAttempts, y = TimeSpent, fill = PhysicalAbuseAttempts)) +
  geom_violin() +
  theme_bw() + 
  guides(fill = FALSE) + 
  labs(x = "Satisfaction With Conflict", y = "Time Spent Together(in years)", title = "Satisfaction By Conflict Time Spent Together") +
  theme(axis.text.x  = element_text(angle = 75, vjust = 0.5, size = 14))
```


*$H_o$: $\pi_{TS}$  = $\pi_{PAA}$*

*$H_a$: $\pi_{TS}$  $\neq$ $\pi_{PAA}$*

*$H_o$: There is no association between time spent and physical abuse attempts frequency in the relationship.*    
*$H_a$: There is no association between time spent and physical abuse attempts frequency in the relationship*

```{r}
PAA[NDF2$PhysicalAbuseAttempts == "never"] <- "0"
PAA[NDF2$PhysicalAbuseAttempts == "this has not happened in the past year, but it did happen before then "] <- "1"
PAA[NDF2$PhysicalAbuseAttempts == "once in the last year of the relationship"] <- "2"
PAA[NDF2$PhysicalAbuseAttempts == "twice in the last year of the relationship"] <- "3"
PAA[NDF2$PhysicalAbuseAttempts == "3 to 5 times in the last year of the relationship"] <- "4"
PAA[NDF2$PhysicalAbuseAttempts == "6 to 10 times in the last year of the relationship"] <- "5"
PAA[NDF2$PhysicalAbuseAttempts == "11 to 20 times in the last year of the relationship"] <- "6"
PAA[NDF2$PhysicalAbuseAttempts == "more than 20 times in the last year of the relationship"] <- "7"

summary(PAA)
DF <- data.frame(NDF2$TimeSpent, PAA)
DF <- DF %>%
  rename(TimeSpent = NDF2.TimeSpent,PhysicalAbuseAttempts = PAA)
summary(DF)

mod1 <- aov(TimeSpent ~ PhysicalAbuseAttempts, data = DF)
mod1
summary(mod1)
Pval <- summary(mod1)[[1]][["Pr(>F)"]][[1]]
Pval
```

Since $`r Pval`$ < 0.01, the null hypothesis is rejected. It can be concluded that there is a very strongly significant association between The Time Spent In Years between the individual with their partners and Physical Abuse Attempts Frequency. 

```{r}
by(DF$TimeSpent, DF$PhysicalAbuseAttempts, mean, na.rm = TRUE)
TukeyHSD(mod1)
```

There are five statistically significant results including:

+ the difference between the mean of "never" and "this has not happened in the past year, but it did happen before then" which is $`r TukeyHSD(mod1)$PhysicalAbuseAttempts[1,4]`< 0.01$. 

+ the difference between the mean of "once in the last year of the relationship" and "this has not happened in the past year, but it did happen before then" which is $`r TukeyHSD(mod1)$PhysicalAbuseAttempts[8,4]`< 0.01$

+ the difference between the mean of "twice in the last year of the relationship" and "this has not happened in the past year, but it did happen before then" which is $`r TukeyHSD(mod1)$PhysicalAbuseAttempts[9,4]`< 0.01$

+ the difference between the mean of "3 to 5 times in the last year of the relationship" and "this has not happened in the past year, but it did happen before then" which is $`r TukeyHSD(mod1)$PhysicalAbuseAttempts[10,4]`< 0.01$

+ the difference between the mean of "6 to 10 times in the last year of the relationship" and "this has not happened in the past year, but it did happen before then" which is $`r TukeyHSD(mod1)$PhysicalAbuseAttempts[11,4]`< 0.01$


###Chi-Square Test

```{r}
NDF4 <- data.frame(NDF3$PhysicalAbuseAttempts, NDF3$SexualAssaults, NDF3$HappinessLevel)
NDF4 <- NDF4 %>%
  rename(PhysicalAbuseAttempts = NDF3.PhysicalAbuseAttempts, SexualAssaults = NDF3.SexualAssaults, HappinessLevel = NDF3.HappinessLevel)
summary(DF)
NDF3$PhysicalAbuseAttempts <- factor(ifelse(NDF3$PhysicalAbuseAttempts %in% c("1", "2", "3", "4", "5", "6", "7"), "Yes", "No"))
NDF3$SexualAssaults <- factor(ifelse(NDF3$SexualAssaults %in% c("1", "2", "3", "4", "5", "6", "7"), "Yes", "No"))

NDF3$HappinessLevel <- factor(ifelse(NDF3$HappinessLevel %in% c("2", "3"), "No", "Yes"))
NDF4$HappinessLevel <- factor(ifelse(NDF4$HappinessLevel %in% c("2", "3"), "No", "Yes"))
T1 <- xtabs(~HappinessLevel + PhysicalAbuseAttempts, data = NDF3)
T1
T2 <- xtabs(~HappinessLevel + SexualAssaults, data = NDF3)
T2
```
*$H_o$: There is no relationship between happiness level and physical abuse attempts frequency in the relationship.*    
*$H_a$: There is a relationship between happiness level and physical abuse attempts frequency in the relationship*

If Happiness Level(HL) and Physical Abuse Attempts(PAA) are independent, then
*P(HL & PAA)=P(HL)×P(PAA)*.
We use this rule for calculating expected counts, one cell at a time in T1:

$Expected Count=\frac{Column Total×Row Total}{Table Total}$

```{r}
chisq.test(T1)$expected
tab <- prop.table(T1, 1)
tab
```
When examining the association between happiness level (categorical response) and physical abuse attempts frequency in the relationship (categorical explanatory), looking up at the table revealed among daily, young adults smokers (my sample), those were victims of physical abuses were more likely to have experienced being unhappy (`r tab[1,2]*100`%) compared to those experiences of being victimed of physical abuses (`r tab[2, 2]*100`%).

We then test my observation through the Chi-Square Test.  
```{r}
ChiS1 <- chisq.test(T1, correct = FALSE)
ChiS1

ChiS11 <- chisq.test(T2, correct = FALSE)
ChiS11
```

From the Chi-Square test, we find that the p-value for these tests are $`r ChiS1[3]`$ and $`r ChiS11[3]`$ which are extrememly small and definitely smaller than 0.01 which indicate that it is statistically significant. Therefore, we have a very strong evidence and we can reject the null hypothesis and accept the alternative hypothesis that there is a relationship between happiness level and physical abuse attempts frequency in the relationship($\chi ^2 = `r ChiS1[1]`, df = `r ChiS1[2]`, p = `r ChiS1[3]` < 0.01$) and there is a relationship between happiness level and sexual assaults frequency in the relationship($\chi ^2 = `r ChiS11[1]`, df = `r ChiS11[2]`, p = `r ChiS11[3]` < 0.01$).

####Post-hoc Test

```{r}
T2 <- xtabs(~HappinessLevel + PhysicalAbuseAttempts, data = NDF4)
T2
prop.table(T2, 1)
ChiS2 <- chisq.test(T2, correct = FALSE)
ChiS2
```
A Chi Square test of independence revealed that among individuals that are in their relationships, happiness level and physical abuse attempts frequency in the relationship were significantly associated, $\chi ^2 = `r ChiS2[1]`, df = `r ChiS2[2]`, p = `r ChiS2[3]` < 0.01$. 

```{r}
n <- choose(ncol(T2), nrow(T2))
limit <- 0.05/n
limit
```

Now, there will be 28 post hoc tests comparing between columns of variable the physical abuse attempts frequency. The standard significant for gauging the smallness of a p-value is 0.05 but there are 28 individual test inside that big one so we have to divide it by 28. Therefore, the result of one of these test would be significant if the post hoc test has a p-value that is less than `r limit`.

```{r}
chisq.test(T2[, c(1, 2)], correct = FALSE)
chisq.test(T2[, c(1, 3)], correct = FALSE)
chisq.test(T2[, c(1, 4)], correct = FALSE)
chisq.test(T2[, c(1, 5)], correct = FALSE)
chisq.test(T2[, c(1, 6)], correct = FALSE)
chisq.test(T2[, c(1, 7)], correct = FALSE)
chisq.test(T2[, c(1, 8)], correct = FALSE)

chisq.test(T2[, c(2, 3)], correct = FALSE)
chisq.test(T2[, c(2, 4)], correct = FALSE)
chisq.test(T2[, c(2, 5)], correct = FALSE)
chisq.test(T2[, c(2, 6)], correct = FALSE)
chisq.test(T2[, c(2, 7)], correct = FALSE)
chisq.test(T2[, c(2, 8)], correct = FALSE)


chisq.test(T2[, c(3, 4)], correct = FALSE)
chisq.test(T2[, c(3, 5)], correct = FALSE)
chisq.test(T2[, c(3, 6)], correct = FALSE)
chisq.test(T2[, c(3, 7)], correct = FALSE)
chisq.test(T2[, c(3, 8)], correct = FALSE)


chisq.test(T2[, c(4, 5)], correct = FALSE)
chisq.test(T2[, c(4, 6)], correct = FALSE)
chisq.test(T2[, c(4, 7)], correct = FALSE)
chisq.test(T2[, c(4, 8)], correct = FALSE)


chisq.test(T2[, c(5, 6)], correct = FALSE)
chisq.test(T2[, c(5, 7)], correct = FALSE)
chisq.test(T2[, c(5, 8)], correct = FALSE)

chisq.test(T2[, c(6, 7)], correct = FALSE)
chisq.test(T2[, c(6, 8)], correct = FALSE)

chisq.test(T2[, c(7, 8)], correct = FALSE)
```

Post hoc comparisons of happiness level and physical abuse attempts frequency categories revealed that higher rates of unhappiness were seen among those being victimed of more physical abuse attempts frequency, up to 11 to 20 times in the last year of the relationship. After the above process, it was found that there were 7 significant results including: 

-"never" and "this has not happened in the past year, but it did happen before then" (Column 0 and 1) 

-"never" and "once in the last year of the relationship" (Column 0 and 2), 

-"never" and "twice in the last year of the relationship" (Column 0 and 3)

-"never" and "3 to 5 times in the last year of the relationship" (Column 0 and 4)

-"never" and "6 to 10 times in the last year of the relationship" (Column 0 and 5) 

-"never" and "more than 20 times in the last year of the relationship" (Column 0 and 7)

###Correlation Coefficient $(r)$ $Q→Q$

```{r}
NDF$PeopleMarried <- gsub(",", "", NDF$PeopleMarried)
NDF$PeopleMarried <- as.numeric(NDF$PeopleMarried)

ggplot(data = NDF, aes(x = PeopleMarried, y = TimeSpent)) + 
  geom_point() +
  theme_bw() +
  geom_smooth(method = "lm") + 
  labs(x = "People that the individual subject married in the past", y = "Time Spent Together(in years)", title = "Correlation Graph") 
```

My codebook has significantly more categorical variables than quantitative variables. The ones I found that are relavant to my research only produced 58 data points generated as a result which indicates a weak relationship. However, the scatterplot did suggest a relationship that is positive and close to a linear form.


```{r}
cor.test(NDF$PeopleMarried, NDF$TimeSpent, use = "complete.obs")
r <- cor(NDF$PeopleMarried, NDF$TimeSpent, use = "complete.obs")
r
variance <- r^2
variance
```

Among individuals (my sample), the correlation between number of people that they married in the past (quantitative) and number of time spent together (in years) (quantitative) was `r r` (p < 0.0001), suggesting that only `r variance*100`% (i.e. `r r` squared) of the variance in number of time spent together can be explained by number of the number of people that they married in the past.

As mentioned above, the scatterplot suggests a relationship that is positive. However, the value of the correlation that we find between the two variables is r= `r r`, which is closer to 0 than 1, which indicates a weak linear relationship between the two variables. 

###Linear Regression

First, the data is placed on the search path using the `alr4` package.
The variables of interest are selected and stored in the data frame `LRDF` using the `select` function from the `dplyr` package. Then, those variables of interest including `Velocity` and `Dist` varibles. A data frame with 96 observations was used to investigate the relationship between the velocity of the baseball and the distance that the baseball travels.
```{r}
library(alr4)
summary(domedata)
LRDF <- domedata %>%
  select(Velocity, Dist)
cor.test(LRDF$Velocity, LRDF$Dist, use = "complete.obs")
r2 <- cor(LRDF$Velocity, LRDF$Dist, use = "complete.obs")
```
The correlation `r r2` is pretty strong > 0.5, however, doesn’t fully characterize the linear relationship between two quantitative variables—it only measures the strength and direction (positive and linear). Therefore, we will need to summarize the linear relationship through trying to fit a line that best fits the linear pattern of the data between the `Velocity` and `Dist` variables.

```{r}
library(ggplot2)
ggplot(data = LRDF, aes(x = Velocity, y = Dist)) + 
    geom_point(color = "purple") +
    theme_bw() + 
    labs(x = "Velocity of the Baseball(feet/second)", y = "Distance Traveling(feet)") 
```

The above graph is a scatter plot of all the data of two variables in the `LRDF` data frame including Velocity of the Baseball (feet/second) and Distance Travelling of the baseball (feet). One can see a positive correlation with a linear form of a relaitonship between these two variables from the figure and the result of the correlation test above. We will investigate the relationship these twos more in-depth. 

```{r}
mod.lm <- lm(Dist~Velocity, data = LRDF)
summary(mod.lm)
plot(mod.lm, which = 1)
```
It is evident that the residual graph does not show any pattern. I am confident to be able to summarize the linear relationship by trying to fit a line that best fits the linear pattern of the data.


```{r}
MEAN <- apply(LRDF, 2, mean)
SD <- apply(LRDF, 2, sd)
MEAN
SD
coef(summary(mod.lm))
b <- coef(summary(mod.lm))[2, 1]
```

The slope of the fitted line is: 

$$b = r*\frac{\Delta Dist}{\Delta Velocity}$$ 

$$<=>b = `r r2` * \frac{`r SD[2]`}{`r SD[1]`} = `r b`$$

This means that for every 1-unit increase of the explanatory variable, there is, on average, a `r b`-unit increase in the response variable. Specifically, for every feet per second that the baseball travels faster, the maximum distance by a baseball increases, on average, by `r b` feet.

The intercept of the line is:
$a = `r MEAN[2]` - `r b`*`r MEAN[1]` = `r coef(summary(mod.lm))[1,1]`$

And therefore the least squares regression line for this case is:

$\hat{Dist} = `r b`*Velocity `r coef(summary(mod.lm))[1,1]`$

```{r}
ggplot(data = LRDF, aes(x = Velocity, y = Dist)) + 
    geom_point(color = "purple") +
    theme_bw() + 
    labs(x = "Velocity of the Baseball(feet/second", y = "Distance Traveling(feet)") + 
    geom_smooth(method = "lm", se = TRUE) +
    labs(title = expression(hat(Y) == "2.3637909x − 13.4766605") )
```

The figure above is the regression line trying to fit the linear pattern of the data of the scatter plot. Evidently, it fits the linear pattern of the data quite well.

```{r}
PV <- predict(mod.lm, newdata = data.frame(Velocity = 159))
PV
```

Practically, what the figure tells us is that in order to find the predicted maximum distance for a 159(feet/second), we plug Velocity = 159 into the regression line equation, to find that:

Predicted distance = (2.3637909 * 159) - 13.4766605= `r PV`. `r PV` feet is our best prediction for the maximum distance at which the velocity is 159.